---
import { Image } from 'astro:assets';
import BaseHead from "../components/BaseHead.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";
import { BASE_URL } from "../consts";
// const { BASE_URL} = Astro.props;

const getData = async () => {
	try {
		const res = await fetch(`${BASE_URL}/api/homapage?populate=*`);
		const json = await res.json();
		return json;
	} catch (error) {
		return null;
	}
};
const data = await getData();
const contentEditio = data?.data.custom_editor_one;
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title="Radiogoldinformation" description={SITE_DESCRIPTION} />
	</head>
	<body>
		<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MB7QQVSD"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
		<div
			id="login-toggle-wrapper"
			class="login-toggle-wrapper hidden"
			aria-hidden="true"
		>
			<button
				id="login-toggle"
				class="toggle-switch"
				role="switch"
				aria-checked="false"
				aria-label="User option toggle"
			>
				<span class="toggle-track"></span>
				<span class="toggle-circle"></span>
			</button>
			<span class="toggle-label">Save</span>
		</div>

		<section
			class="banner-section home"
			style={`background-image: url(${data.data.banner_image.formats.medium.url})`}
		>
			<div class="container">
				<div class="banner-content">
					<h1 class="main-title">{data.data.banner_title}</h1>
					<p class="main-subtitle">{data.data.banner_paragraph}</p>
				</div>
			</div>
		</section>

		<section class="content-section">
			<div class="container">
				<div class="c-flex">
					<div class="main-details" data-aos="fade-up">
						<h4 class="content-heading">
							{data.data.about_heading}
						</h4>
						{
							data.data.about_editior.map((item, i) => {
								const baseUrl =
									(typeof process !== "undefined" &&
										process.env &&
										process.env.NEXT_PUBLIC_API_URL) ||
									"http://localhost:1337";

								const buildImageSrc = (imgObj) => {
									if (!imgObj) return null;
									const formats = imgObj.formats || {};
									const pick =
										(formats.small && formats.small.url) ||
										(formats.medium &&
											formats.medium.url) ||
										(formats.thumbnail &&
											formats.thumbnail.url) ||
										imgObj.url;
									if (!pick) return null;
									if (/^https?:\/\//i.test(pick)) return pick;
									if (pick.startsWith("/"))
										return `${baseUrl.replace(/\/$/, "")}${pick}`;
									return `${baseUrl.replace(/\/$/, "")}/${pick}`;
								};

								if (item.type === "heading") {
									const Tag = `h${Math.min(Math.max(item.level, 1), 6)}`;
									return item.children.map((content, j) => (
										<Tag key={`${i}-heading-${j}`}>
											{content.text}
										</Tag>
									));
								}
								if (item.type === "paragraph") {
									return (
										<p key={`para-${i}`}>
											{item.children.map((content, j) => {
												let text = <>{content.text}</>;

												if (content.bold)
													text = (
														<strong>{text}</strong>
													);
												if (content.italic)
													text = <em>{text}</em>;
												if (content.underline)
													text = <u>{text}</u>;

												if (
													content.type === "link" ||
													content.url ||
													content.href
												) {
													const href =
														content.url ||
														content.href ||
														"#";
													const target =
														content.target ||
														(href.startsWith("http")
															? "_blank"
															: undefined);
													const children = (
														content.children || []
													).map((c, k) => (
														<span
															key={`link-${i}-${j}-${k}`}
														>
															{c.text}
														</span>
													));
													text = (
														<a
															href={href}
															target={target}
															rel={
																target ===
																"_blank"
																	? "noopener noreferrer"
																	: undefined
															}
														>
															{children.length
																? children
																: text}
														</a>
													);
												}

												return (
													<span
														key={`${i}-inline-${j}`}
													>
														{text}
													</span>
												);
											})}
										</p>
									);
								}

								if (item.type === "image") {
									const imgObj = item.image || item;
									const src = buildImageSrc(imgObj);
									const alt =
										imgObj?.alternativeText ||
										imgObj?.caption ||
										"image";
									const caption = imgObj?.caption;

									return (
										<figure
											key={`img-${i}`}
											style={{ margin: "1rem 0" }}
										>
											{src ? (
												<img
													src={src}
													alt={alt}
													width={imgObj?.width}
													height={imgObj?.height}
													style={{
														maxWidth: "100%",
														height: "auto",
														display: "block",
													}}
												/>
											) : (
												<div
													style={{
														padding: "1rem",
														background: "#f4f4f4",
													}}
												>
													Image unavailable
												</div>
											)}
											{caption && (
												<figcaption
													style={{
														fontSize: "0.9rem",
														color: "#666",
													}}
												>
													{caption}
												</figcaption>
											)}
										</figure>
									);
								}

								// --- Lists (ordered & unordered) ---
								if (item.type === "list") {
									const ListTag =
										item.format === "ordered" ? "ol" : "ul";
									return (
										<ListTag key={`list-${i}`}>
											{(item.children || []).map(
												(li, j) => (
													<li key={`${i}-li-${j}`}>
														{(
															li.children || []
														).map((c, k) => {
															let text = (
																<>{c.text}</>
															);
															if (c.bold)
																text = (
																	<strong>
																		{text}
																	</strong>
																);
															if (c.italic)
																text = (
																	<em>
																		{text}
																	</em>
																);
															if (c.underline)
																text = (
																	<u>
																		{text}
																	</u>
																);
															return (
																<span
																	key={`li-${i}-${j}-${k}`}
																>
																	{text}
																</span>
															);
														})}
													</li>
												),
											)}
										</ListTag>
									);
								}

								return null;
							})
						}
					</div>
					<div class="content-img data-flow">
						<img
							src={`${data.data.about_image.formats.large.url}`}
							width="436"
							height="329"
							alt="frog"
							data-aos="fade-left" loading="lazy"
						/>
						<p class="text-center">{data.data.about_bottom_para}</p>
					</div>
				</div>
			</div>
		</section>
		<section class="sprit-section pt-0" data-aos="fade-up">
			<div class="container">
				<div class="sprit-img">
					<img
						src={`${data.data.last_image.formats.large.url}`}
						alt="sprit" loading="lazy"
					/>
				</div>
				<div class="sprit-content">
					<h3 class="sprit-heading">{data.data.last_heading}</h3>
				</div>
			</div>
		</section>
		<a id="myBtn" href="/page1" title="Scroll Up">Continue</a>

		<!-- <Footer /> -->
	</body>
</html>
